<div class="row mb-114">
  <div class="come-back">
    <ob-back-button [currentPage]="'currency_controll'"></ob-back-button>
  </div>
  <div
    class="col-dt-9 col-lgdt-8 col-smdt-12 g-custom"
    [formGroup]="currencyTransferForm">
    <div class="currency-transfer">
      <h1 class="currency-transfer-title">
        {{ 'currencyControl.currencyTransfer.name' | translate }}
      </h1>
      <!-- Номер документа и дата -->
      <section class="currency-transfer-autofill">
        <div class="currency-transfer-autofill__text">
          <span class="currency-transfer-autofill__secondary me-2">
            {{ 'operations.default.valueDate' | translate }}:
          </span>
          <span class="contragent-autofill__main">{{
            prefill?.valDate.split('-').reverse().join('.')
          }}</span>
        </div>
      </section>
      <!-- Номер документа и дата -->

      <!-- progress -->
      <section class="currency-transfer__progress">
        <div class="line-wrapper">
          <div
            *ngFor="let item of steps"
            [ngClass]="displayProgress(item) ? 'line' : 'display-none'">
            <ng-template [ngIf]="displayProgress(item)">
              <div
                class="half_line1"
                [ngStyle]="{ width: item.progress + '%' }"></div>
              <div
                class="half_line2"
                [ngStyle]="{ width: 100 - item.progress + '%' }"></div>
            </ng-template>
          </div>
        </div>

        <div class="currency-transfer__progress-info">
          <p>
            {{ 'default.step' | translate }}
            {{ !isBudgetPayment && currentStep === 3 ? 3 : currentStep + 1 }}
            {{ 'settings.tarif.from' | translate }}
            {{ isBudgetPayment ? 4 : 3 }}
          </p>
          <p>
            {{ 'default.filled' | translate }}
            {{ steps[currentStep].progress }}%
            {{ 'currencyControl.currencyTransfer.for' | translate }}
            {{ !isBudgetPayment && currentStep === 3 ? 3 : currentStep + 1 }}-й
            {{ 'default.step' | translate | lowercase }}
          </p>
        </div>
      </section>
      <!-- progress -->
      <!-- Step 1 -->
      <div *ngIf="currentStep === 0">
        <section class="currency-transfer__form" [formGroup]="currentGroup">
          <p class="currency-transfer__form-title mb-16">
            {{ 'currencyControl.currencyTransfer.sender' | translate }} (50)
          </p>
          <div class="row g-24 mb-16">
            <!-- УНК -->
            <div
              class="col-dt-6 col-tb-6 col-mb-12"
              id="bootstrap-overrides-region">
              <ng-select
                formControlName="unk"
                class="custom-select floating-label search-list-icon"
                placeholder="{{
                  'currencyControl.currencyTransfer.unkPlaceholder' | translate
                }}"
                [clearable]="true"
                [ngClass]="displayFieldClass('unk')"
                notFoundText="{{ 'default.not_found' | translate }}"
                id="unk"
                [editableSearchTerm]="true"
                loadingText="{{ 'default.loading' | translate }}..."
                (change)="onUnkChange($event)"
                [loading]="contractListLoading">
                <ng-option
                  *ngFor="let contract of contractList"
                  [value]="contract">
                  <p class="unk-text-bold">
                    {{ contract.contractNumber }}, {{ contract.contractSum }}
                    {{
                      helperService.formatCurrency(contract.contractCurrency)
                    }}
                  </p>
                  <p class="unk-text-gray">
                    {{ contract.inoPartnerBankName }}, {{ contract.unk }}
                  </p>
                  <p class="unk-text-gray">{{ contract.makeDate }}</p>
                </ng-option>
              </ng-select>
              <ob-field-error-display
                [displayError]="isFieldInvalid('unk')"
                errorMsg="{{ 'error.required' | translate }}">
              </ob-field-error-display>
            </div>
            <!-- УНК -->
            <!-- Валюта -->
            <div
              class="col-dt-6 col-tb-6 col-mb-12"
              id="bootstrap-overrides-region">
              <ng-select
                formControlName="currency"
                class="custom-select account-currency"
                required
                [searchable]="false"
                [clearable]="false"
                [ngClass]="displayFieldClass('currency')"
                notFoundText="{{ 'error.empty-data' | translate }}"
                placeholder="{{ 'default.currency' | translate }}"
                dropdownPosition="bottom"
                id="currency"
                loadingText="{{ 'default.loading' | translate }}...">
                <ng-option
                  *ngFor="let currency of currencyList"
                  [value]="currency.isoCode">
                  <div class="currency-item">
                    <span class="icon icon_{{ currency.isoCode }}"></span>
                    <span class="currency-item__text">
                      <p class="currency-item__iso currency-item__text-bold">
                        {{ currency.isoCode }} -
                      </p>
                      <p class="currency-item__name">{{ currency.name }}</p>
                    </span>
                  </div>
                </ng-option>
              </ng-select>
              <ob-field-error-display
                *ngIf="currentGroup.get('currency').hasError('required')"
                [displayError]="isFieldInvalid('currency')"
                errorMsg="{{ 'error.required' | translate }}">
              </ob-field-error-display>
            </div>
            <!-- Валюта -->
          </div>
          <div class="row g-24 mb-40">
            <!-- Счет отправителя -->
            <div class="col-dt-6 col-tb-6 col-mb-12">
              <ng-select
                formControlName="accountSender"
                class="custom-select account-withdraw"
                [searchable]="false"
                [clearable]="false"
                placeholder="{{
                  'operations.default.withdrawalAccount' | translate
                }}"
                [ngClass]="displayFieldClass('accountSender')"
                notFoundText="{{ 'error.empty-data' | translate }}"
                required
                dropdownPosition="bottom"
                id="accountSender"
                loadingText="{{ 'default.loading' | translate }}...">
                <ng-option
                  *ngFor="let account of accountList"
                  [value]="account?.iban">
                  <ob-select-account
                    [description]="account.iban"
                    [title]="account.actualBalance"
                    [icon]="getIcon(account.currency)"
                    [currency]="account.currency"></ob-select-account>
                </ng-option>
              </ng-select>
              <ob-field-error-display
                *ngIf="currentGroup.get('accountSender').hasError('required')"
                [displayError]="isFieldInvalid('accountSender')"
                errorMsg="{{ 'error.account_not_selected' | translate }}">
              </ob-field-error-display>
            </div>
            <!-- Счет отправителя -->
            <!-- Сумма -->
            <div class="col-dt-6 col-tb-6 col-mb-12">
              <div class="form-floating">
                <input
                  class="form-control base-input"
                  [ngClass]="displayFieldClass('amount')"
                  autocomplete="off"
                  type="text"
                  required="required"
                  placeholder="{{
                    'operations.countragent.amount' | translate
                  }}"
                  formControlName="amount"
                  mask="separator.2"
                  thousandSeparator=" "
                  separatorLimit="999999999999999999"
                  suffix=" {{
                    getGroupAt(0).get('amount').value
                      ? helperService.formatCurrency(transferCurrency)
                      : ''
                  }}"
                  id="amount"
                  #amount />
                <label for="floatingInput">{{
                  'operations.countragent.amount' | translate
                }}</label>
              </div>
              <div>
                <ob-field-error-display
                  *ngIf="currentGroup.get('amount').errors?.required"
                  [displayError]="isFieldInvalid('amount')"
                  errorMsg="{{ 'error.required' | translate }}">
                </ob-field-error-display>
                <ob-field-error-display
                  *ngIf="currentGroup.get('amount').errors?.incorrectAmount"
                  [displayError]="isFieldInvalid('amount')"
                  errorMsg="{{ 'error.filledIncorrectly' | translate }}">
                </ob-field-error-display>
                <ob-field-error-display
                  *ngIf="
                    insufficientFunds &&
                    !currentGroup.get('amount').errors?.required &&
                    !currentGroup.get('amount').hasError('zeroSum')
                  "
                  [displayError]="insufficientFunds"
                  errorMsg="{{ 'error.amount' | translate }}">
                </ob-field-error-display>
                <ob-field-error-display
                  *ngIf="
                    currentGroup.get('amount').hasError('zeroSum') &&
                    !currentGroup.get('amount').errors?.required
                  "
                  [displayError]="isFieldInvalid('amount')"
                  errorMsg="{{ 'error.zeroSumTransfer' | translate }}">
                </ob-field-error-display>
              </div>
            </div>
            <!-- Сумма -->
          </div>

          <p class="currency-transfer__form-title">
            {{
              'currencyControl.currencyTransfer.currencyControlDocs' | translate
            }}
          </p>
          <div>
            <div
              class="file-drop-area"
              [ngClass]="{
                'file-over': fileOver,
                error_area: error !== '',
                'file-invalid': fileMaxSizeError || fileFormatError
              }">
              <span class="file-message"
                >{{ 'operations.imports.fileMovement' | translate }}
                {{ 'general.or' | translate }}
                <span class="choose-file-button"
                  >{{ 'operations.imports.fileLoading' | translate }}
                </span>
                <br /><span class="file-message-light-gray">
                  {{ allowedFormats.join(', ') + ' ' }}
                  {{
                    'currencyControl.currencyTransfer.fileMaxSize' | translate
                  }}
                </span>
              </span>
              <input
                class="form-control file-input"
                id="fileDropArea"
                type="file"
                autocomplete="off"
                (change)="fileChange($event)"
                multiple />
            </div>
            <ob-field-error-display
              *ngIf="fileMaxSizeError"
              [displayError]="fileMaxSizeError"
              errorMsg="{{ 'error.contractFileSize' | translate }}">
            </ob-field-error-display>
            <ob-field-error-display
              *ngIf="fileFormatError"
              [displayError]="fileFormatError"
              errorMsg="{{ 'error.wrongFileFormat' | translate }}">
            </ob-field-error-display>
            <div>
              <div
                class="uploaded-file"
                *ngFor="let file of fileList; let i = index">
                <div class="uploaded-file__content">
                  <span
                    class="icon"
                    [ngClass]="
                      getFileFormat(file) === 'pdf'
                        ? 'icon_pdf-document'
                        : 'icon_default-document'
                    "></span>
                  <div>
                    <p class="uploaded-file__text-bold">{{ file.name }}</p>
                    <p class="uploaded-file__text-gray">
                      {{ 'default.file-uploaded' | translate }}
                    </p>
                  </div>
                </div>
                <div class="uploaded-file__delete">
                  <p class="uploaded-file__text-gray">
                    {{ getFormattedFileSize(file.size) }}
                  </p>
                  <span class="icon icon_close-delete" (click)="deleteDoc(i)">
                  </span>
                </div>
              </div>
            </div>
          </div>

          <ng-template [ngIf]="!this.currentGroup.get('unk').value">
            <div class="currency-transfer__agreement">
              <input
                class="form-check-input currency-transfer__agreement-check"
                type="checkbox"
                formControlName="isConfirmAgreement"
                id="isConfirmAgreement" />
              <label
                class="currency-transfer__agreement-text"
                for="isConfirmAgreement">
                {{
                  'currencyControl.currencyTransfer.agreementText' | translate
                }}
              </label>
            </div>
          </ng-template>
        </section>
      </div>
      <!-- Step 1 -->

      <!-- Step 2 -->
      <div *ngIf="currentStep === 1">
        <section class="currency-transfer__form" [formGroup]="currentGroup">
          <p class="currency-transfer__form-title mb-16">
            {{ 'operations.default.destination' | translate }} (59)
          </p>
          <div class="row g-24">
            <ng-template [ngIf]="transferCurrency === 'RUB'">
              <!-- ИНН -->
              <div class="col-dt-6 col-tb-6 col-mb-12 mb-16">
                <div
                  class="form-floating"
                  [tooltip]="tooltipInn"
                  [delay]="100"
                  #popInn="bs-tooltip"
                  (click)="popInn.hide()"
                  (keypress)="popInn.hide()">
                  <input
                    formControlName="inn"
                    type="text"
                    [ngClass]="displayFieldClass('inn')"
                    class="form-control base-input"
                    id="inn"
                    mask="0*"
                    maxlength="{{
                      getGroupAt(1).get('kbe').value === '29' ? 12 : 10
                    }}"
                    minlength="{{
                      getGroupAt(1).get('inn').value !== '0'
                        ? getGroupAt(1).get('kbe').value === '29'
                          ? 12
                          : 10
                        : 0
                    }}"
                    placeholder="{{ 'default.inn' | translate }}"
                    autocomplete="off" />
                  <label for="inn">{{ 'default.inn' | translate }}</label>
                </div>
                <ng-template #tooltipInn>
                  <ob-tooltip [type]="'inn'"></ob-tooltip>
                </ng-template>
                <ob-field-error-display
                  *ngIf="this.currentGroup.get('inn').hasError('required')"
                  [displayError]="isFieldInvalid('inn')"
                  errorMsg="{{ 'error.required' | translate }}">
                </ob-field-error-display>
                <ob-field-error-display
                  *ngIf="this.currentGroup.get('inn').hasError('maxlength')"
                  [displayError]="isFieldInvalid('inn')"
                  errorMsg="{{
                    getGroupAt(1).get('kbe').value === '29'
                      ? ('error.fieldLength12' | translate)
                      : ('error.fieldLength10' | translate)
                  }}">
                </ob-field-error-display>
                <ob-field-error-display
                  *ngIf="this.currentGroup.get('inn').hasError('minlength')"
                  [displayError]="isFieldInvalid('inn')"
                  errorMsg="{{
                    getGroupAt(1).get('kbe').value === '29'
                      ? ('error.fieldLength12' | translate)
                      : ('error.fieldLength10' | translate)
                  }}">
                </ob-field-error-display>
              </div>
              <!-- ИНН -->
            </ng-template>
            <!-- Получатель -->
            <div
              [ngClass]="
                transferCurrency === 'RUB'
                  ? 'col-dt-6 col-tb-6 col-mb-12'
                  : 'col-dt-12 col-tb-12 col-mb-12'
              "
              id="bootstrap-overrides-region"
              class="mb-16">
              <ng-select
                formControlName="recipientName"
                class="custom-select floating-label"
                placeholder="{{
                  'currencyControl.currencyTransfer.recipientName' | translate
                }}"
                [searchable]="true"
                (search)="onRecipientSearch($event)"
                [ngClass]="displayFieldClass('recipientName')"
                notFoundText="{{ 'default.not_found' | translate }}"
                id="recipientName"
                [editableSearchTerm]="true"
                loadingText="{{ 'default.loading' | translate }}..."
                [loading]="recipientListLoading"
                (change)="onRecipientChange($event)">
                <ng-option
                  *ngFor="let recipient of recipientList"
                  [value]="recipient">
                  <p class="unk-text-bold">{{ recipient.name }}</p>
                  <p class="unk-text-gray">{{ recipient.bankName }}</p>
                  <p class="unk-text-gray">{{ recipient.bankBic }}</p>
                </ng-option>
              </ng-select>
              <div class="currency-transfer-inputs__textarea-bottom">
                <div>
                  <ob-field-error-display
                    *ngIf="
                      currentGroup.get('recipientName').hasError('required')
                    "
                    [displayError]="isFieldInvalid('recipientName')"
                    errorMsg="{{ 'error.required' | translate }}">
                  </ob-field-error-display>
                  <ob-field-error-display
                    *ngIf="
                      currentGroup
                        .get('recipientName')
                        .hasError('invalidSymbolLatin')
                    "
                    [displayError]="isFieldInvalid('recipientName')"
                    errorMsg="{{
                      'error.invalidSymbolEnteredAllowed' | translate
                    }} A-Z, a-z, 0-9, -'./,()?">
                  </ob-field-error-display>
                  <ob-field-error-display
                    *ngIf="
                      currentGroup
                        .get('recipientName')
                        .hasError('invalidSymbolCyryillic')
                    "
                    [displayError]="isFieldInvalid('recipientName')"
                    errorMsg="{{
                      'error.invalidSymbolEnteredAllowed' | translate
                    }} A-Z, a-z, А-Я, а-я, 0-9, -'./,()?">
                  </ob-field-error-display>
                  <ob-field-error-display
                    *ngIf="isMaxLengthError && errorField === 'recipientName'"
                    [displayError]="isMaxLengthError"
                    errorMsg="{{
                      'error.transferGeneralLengthError' | translate
                    }}">
                  </ob-field-error-display>
                </div>
                <div class="currency-transfer-inputs__textarea-length">
                  {{ generalLength }}/140
                </div>
              </div>
            </div>
            <!-- Получатель -->
          </div>
          <ng-template
            [ngIf]="showPassportFields && transferCurrency === 'RUB'">
            <div class="row g-24">
              <!-- Номер паспорта -->
              <div class="col-dt-6 col-tb-6 col-mb-12 mb-16">
                <div class="form-floating">
                  <input
                    formControlName="recipientPassportNum"
                    class="form-control base-input"
                    [ngClass]="displayFieldClass('recipientPassportNum')"
                    autocomplete="off"
                    type="text"
                    required="required"
                    placeholder="{{
                      'currencyControl.currencyTransfer.passportNum' | translate
                    }}"
                    maxlength="20"
                    id="recipientPassportNum" />

                  <label for="floatingInput">{{
                    'currencyControl.currencyTransfer.passportNum' | translate
                  }}</label>
                </div>
                <div>
                  <ob-field-error-display
                    *ngIf="
                      currentGroup.get('recipientPassportNum').errors?.required
                    "
                    [displayError]="isFieldInvalid('recipientPassportNum')"
                    errorMsg="{{ 'error.required' | translate }}">
                  </ob-field-error-display>
                  <ob-field-error-display
                    *ngIf="
                      currentGroup
                        .get('recipientPassportNum')
                        .hasError('pattern')
                    "
                    [displayError]="isFieldInvalid('recipientPassportNum')"
                    errorMsg="{{
                      'error.invalidSymbolEnteredAllowed' | translate
                    }} A-Z, А-Я, 0-9">
                  </ob-field-error-display>
                </div>
              </div>
              <!-- Номер паспорта -->
              <!-- Дата выдачи паспорта -->
              <div class="col-dt-6 col-tb-6 col-mb-12 mb-16">
                <div class="form-floating" style="position: relative">
                  <input
                    [ngClass]="displayFieldClass('recipientPassportDate')"
                    type="text"
                    class="form-control base-input capitalize"
                    [required]=""
                    placeholder="{{
                      'currencyControl.currencyTransfer.passportDate'
                        | translate
                    }}"
                    formControlName="recipientPassportDate"
                    id="recipientPassportDate"
                    bsDatepicker
                    [readonly]="true"
                    style="background-color: #fff"
                    (change)="onDateChange()"
                    [bsConfig]="{
                      customTodayClass: 'custom-today-class',
                      isAnimated: true,
                      containerClass: 'payments-calendar',
                      showWeekNumbers: false,
                      maxDate: passportMaxDate,
                      dateInputFormat: 'DD.MM.YYYY'
                    }"
                    #dp="bsDatepicker" />
                  <span class="icon-calendar" (click)="dp.toggle()">
                    <img src="./assets/icons/ic_calendar2.svg" alt="" />
                  </span>
                  <label for="floatingInput">{{
                    'currencyControl.currencyTransfer.passportDate' | translate
                  }}</label>
                </div>
                <ob-field-error-display
                  *ngIf="
                    this.currentGroup
                      .get('recipientPassportDate')
                      .hasError('required')
                  "
                  [displayError]="isFieldInvalid('recipientPassportDate')"
                  errorMsg="{{ 'error.required' | translate }}">
                </ob-field-error-display>
              </div>
              <!-- Дата выдачи паспорта -->
            </div>
          </ng-template>
          <div class="row g-24">
            <!-- Счет получателя -->
            <div class="col-dt-6 col-tb-6 col-mb-12 mb-16">
              <div class="form-floating">
                <input
                  formControlName="accountRecipient"
                  class="form-control base-input"
                  [ngClass]="displayFieldClass('accountRecipient')"
                  autocomplete="off"
                  type="text"
                  required="required"
                  placeholder="{{
                    'currencyControl.currencyTransfer.recipientAccount'
                      | translate
                  }}"
                  maxlength="34"
                  id="accountRecipient" />

                <label for="floatingInput">{{
                  'currencyControl.currencyTransfer.recipientAccount'
                    | translate
                }}</label>
              </div>
              <div>
                <ob-field-error-display
                  *ngIf="currentGroup.get('accountRecipient').errors?.required"
                  [displayError]="isFieldInvalid('accountRecipient')"
                  errorMsg="{{ 'error.required' | translate }}">
                </ob-field-error-display>
                <ob-field-error-display
                  *ngIf="
                    currentGroup.get('accountRecipient').hasError('pattern')
                  "
                  [displayError]="isFieldInvalid('accountRecipient')"
                  errorMsg="{{
                    'error.invalidSymbolEnteredAllowed' | translate
                  }} A-Z, 0-9">
                </ob-field-error-display>
              </div>
            </div>
            <!-- Счет получателя -->
            <!-- КБЕ -->
            <div class="col-dt-6 col-tb-6 col-mb-12 mb-16">
              <div
                class="form-floating"
                [tooltip]="tooltipKbe"
                [delay]="100"
                #pop="bs-tooltip"
                (click)="pop.hide()"
                (keypress)="pop.hide()">
                <input
                  formControlName="kbe"
                  class="form-control base-input"
                  [ngClass]="displayFieldClass('kbe')"
                  autocomplete="off"
                  type="text"
                  placeholder="{{ 'operations.countragent.kbe' | translate }}"
                  mask="00"
                  id="kbe" />
                <label for="floatingInput">{{
                  'operations.countragent.kbe' | translate
                }}</label>
              </div>
              <ng-template #tooltipKbe>
                <ob-tooltip [type]="'kbe'"></ob-tooltip>
              </ng-template>
              <!-- <ob-field-error-display
                        *ngIf="counteragentFormControl.account.errors?.required"
                        [displayError]="isFieldInvalid('account')"
                        errorMsg="{{ 'error.required' | translate }}"
                    >
                    </ob-field-error-display>
                    <ob-field-error-display
                        *ngIf="counteragentFormControl.account.errors?.minlength"
                        [displayError]="isFieldInvalid('account')"
                        errorMsg="{{ 'error.account' | translate }}"
                    >
                    </ob-field-error-display> -->
              <p
                *ngIf="this.currentGroup.get('kbe').hasError('pattern')"
                class="invalid">
                {{ 'error.filledIncorrectly' | translate }}
              </p>
              <p
                *ngIf="
                  (this.currentGroup.get('kbe').touched &&
                    !this.currentGroup.get('kbe').pristine &&
                    this.currentGroup.get('kbe').hasError('required')) ||
                  ((this.currentGroup.get('kbe').value ||
                    this.currentGroup.get('kbe').value === 0) &&
                    this.currentGroup.get('kbe').hasError('required'))
                "
                class="invalid">
                {{ 'error.required' | translate }}
              </p>
            </div>
            <!-- КБЕ -->
          </div>
          <ng-template [ngIf]="transferCurrency === 'RUB'">
            <div class="row g-24">
              <!-- КПП -->
              <div class="col-dt-6 col-tb-6 col-mb-12 mb-16">
                <div class="form-floating">
                  <input
                    formControlName="kpp"
                    type="text"
                    [ngClass]="displayFieldClass('kpp')"
                    class="form-control base-input"
                    id="kpp"
                    maxlength="9"
                    placeholder="{{
                      'currencyControl.currencyTransfer.kpp' | translate
                    }}"
                    autocomplete="off" />
                  <label for="kpp">{{
                    'currencyControl.currencyTransfer.kpp' | translate
                  }}</label>
                </div>
                <ob-field-error-display
                  *ngIf="currentGroup.get('kpp').hasError('required')"
                  [displayError]="isFieldInvalid('kpp')"
                  errorMsg="{{ 'error.required' | translate }}">
                </ob-field-error-display>
                <ob-field-error-display
                  *ngIf="currentGroup.get('kpp').hasError('pattern')"
                  [displayError]="isFieldInvalid('kpp')"
                  errorMsg="{{
                    'error.invalidSymbolEnteredAllowed' | translate
                  }} A-Z, 0-9">
                </ob-field-error-display>
                <ob-field-error-display
                  *ngIf="
                    !currentGroup.get('kpp').hasError('pattern') &&
                    (currentGroup.get('kpp').hasError('maxlength') ||
                      currentGroup.get('kpp').hasError('minlength'))
                  "
                  [displayError]="isFieldInvalid('kpp')"
                  errorMsg="{{ 'error.kppLength' | translate }}">
                </ob-field-error-display>
              </div>
              <!-- КПП -->
            </div>
          </ng-template>

          <p class="currency-transfer__form-title mb-16 mt-32">
            {{
              'currencyControl.currencyTransfer.recipientAddress' | translate
            }}
          </p>
          <div class="row g-24">
            <!-- Страна -->
            <div
              class="col-dt-6 col-tb-6 col-mb-12 mb-16"
              id="bootstrap-overrides-region">
              <ng-select
                formControlName="recipientCountry"
                class="custom-select floating-label"
                placeholder="{{ 'default.country' | translate }}"
                [searchable]="isRecipientCountrySearchable"
                [clearable]="true"
                [ngClass]="displayFieldClass('recipientCountry')"
                notFoundText="{{ 'default.not_found' | translate }}"
                id="recipientCountry"
                [editableSearchTerm]="true"
                loadingText="{{ 'default.loading' | translate }}..."
                (change)="onCountryChange($event, 'recipient')"
                (open)="isRecipientCountrySearchable = true"
                (close)="isRecipientCountrySearchable = false"
                [loading]="countryListLoading">
                <ng-option
                  *ngFor="let country of countryList"
                  [value]="country">
                  <p>{{ country.name }}</p>
                </ng-option>
              </ng-select>
              <ob-field-error-display
                *ngIf="
                  currentGroup.get('recipientCountry').hasError('required')
                "
                [displayError]="isFieldInvalid('recipientCountry')"
                errorMsg="{{ 'error.required' | translate }}">
              </ob-field-error-display>
              <ob-field-error-display
                *ngIf="isMaxLengthError && errorField === 'recipientCountry'"
                [displayError]="isFieldInvalid('recipientCountry')"
                errorMsg="{{ 'error.transferGeneralLengthError' | translate }}">
              </ob-field-error-display>
              <ob-field-error-display
                *ngIf="isMaxLengthError && errorField === 'recipientCountry'"
                [displayError]="isMaxLengthError"
                errorMsg="{{ 'error.transferGeneralLengthError' | translate }}">
              </ob-field-error-display>
            </div>
            <!-- Страна -->
            <!-- Город -->
            <div class="col-dt-6 col-tb-6 col-mb-12 mb-16">
              <div class="form-floating">
                <input
                  #recipientCity
                  formControlName="recipientCity"
                  type="text"
                  [ngClass]="displayFieldClass('recipientCity')"
                  class="form-control base-input"
                  id="recipientCity"
                  placeholder="{{ 'products.default.city' | translate }}"
                  autocomplete="off"
                  (change)="recipientCity.value = recipientCity.value.trim()" />
                <label for="recipientCity">{{
                  'products.default.city' | translate
                }}</label>
              </div>
              <ob-field-error-display
                *ngIf="currentGroup.get('recipientCity').hasError('required')"
                [displayError]="isFieldInvalid('recipientCity')"
                errorMsg="{{ 'error.required' | translate }}">
              </ob-field-error-display>
              <ob-field-error-display
                *ngIf="
                  currentGroup
                    .get('recipientCity')
                    .hasError('invalidSymbolLatin')
                "
                [displayError]="isFieldInvalid('recipientCity')"
                errorMsg="{{
                  'error.invalidSymbolEnteredAllowed' | translate
                }} A-Z, a-z, 0-9, -'./,()?">
              </ob-field-error-display>
              <ob-field-error-display
                *ngIf="
                  currentGroup
                    .get('recipientCity')
                    .hasError('invalidSymbolCyryillic')
                "
                [displayError]="isFieldInvalid('recipientCity')"
                errorMsg="{{
                  'error.invalidSymbolEnteredAllowed' | translate
                }} A-Z, a-z, А-Я, а-я, 0-9, -'./,()?">
              </ob-field-error-display>
              <ob-field-error-display
                *ngIf="isMaxLengthError && errorField === 'recipientCity'"
                [displayError]="isMaxLengthError"
                errorMsg="{{ 'error.transferGeneralLengthError' | translate }}">
              </ob-field-error-display>
            </div>
            <!-- Город -->
          </div>
          <div class="row g-24">
            <!-- Улица -->
            <div class="col-dt-6 col-tb-6 col-mb-12 mb-16">
              <div class="form-floating">
                <input
                  #recipientStreet
                  formControlName="recipientStreet"
                  type="text"
                  [ngClass]="displayFieldClass('recipientStreet')"
                  class="form-control base-input"
                  id="recipientStreet"
                  placeholder="{{ 'products.default.street' | translate }}"
                  autocomplete="off"
                  (change)="
                    recipientStreet.value = recipientStreet.value.trim()
                  " />
                <label for="recipientStreet">{{
                  'products.default.street' | translate
                }}</label>
              </div>
              <ob-field-error-display
                *ngIf="currentGroup.get('recipientStreet').hasError('required')"
                [displayError]="isFieldInvalid('recipientStreet')"
                errorMsg="{{ 'error.required' | translate }}">
              </ob-field-error-display>
              <ob-field-error-display
                *ngIf="
                  currentGroup
                    .get('recipientStreet')
                    .hasError('invalidSymbolLatin')
                "
                [displayError]="isFieldInvalid('recipientStreet')"
                errorMsg="{{
                  'error.invalidSymbolEnteredAllowed' | translate
                }} A-Z, a-z, 0-9, -'./,()?">
              </ob-field-error-display>
              <ob-field-error-display
                *ngIf="
                  currentGroup
                    .get('recipientStreet')
                    .hasError('invalidSymbolCyryillic')
                "
                [displayError]="isFieldInvalid('recipientStreet')"
                errorMsg="{{
                  'error.invalidSymbolEnteredAllowed' | translate
                }} A-Z, a-z, А-Я, а-я, 0-9, -'./,()?">
              </ob-field-error-display>
              <ob-field-error-display
                *ngIf="isMaxLengthError && errorField === 'recipientStreet'"
                [displayError]="isMaxLengthError"
                errorMsg="{{ 'error.transferGeneralLengthError' | translate }}">
              </ob-field-error-display>
            </div>
            <!-- Улица -->
            <!-- <div class="row col-dt-6 col-tb-6 col-mb-12"> -->
            <!-- Дом -->
            <div class="col-dt-3 col-tb-3 col-mb-6 mb-16">
              <div class="form-floating">
                <input
                  #recipientBuilding
                  formControlName="recipientBuilding"
                  type="text"
                  [ngClass]="displayFieldClass('recipientBuilding')"
                  class="form-control base-input"
                  id="recipientBuilding"
                  placeholder="{{ 'products.default.house' | translate }}"
                  autocomplete="off"
                  (change)="
                    recipientBuilding.value = recipientBuilding.value.trim()
                  " />
                <label for="recipientBuilding">{{
                  'products.default.house' | translate
                }}</label>
              </div>
              <ob-field-error-display
                *ngIf="
                  currentGroup.get('recipientBuilding').hasError('required')
                "
                [displayError]="isFieldInvalid('recipientBuilding')"
                errorMsg="{{ 'error.required' | translate }}">
              </ob-field-error-display>
              <ob-field-error-display
                *ngIf="
                  currentGroup
                    .get('recipientBuilding')
                    .hasError('invalidSymbolLatin')
                "
                [displayError]="isFieldInvalid('recipientBuilding')"
                errorMsg="{{
                  'error.invalidSymbolEnteredAllowed' | translate
                }} A-Z, a-z, 0-9, -'./,()?">
              </ob-field-error-display>
              <ob-field-error-display
                *ngIf="
                  currentGroup
                    .get('recipientBuilding')
                    .hasError('invalidSymbolCyryillic')
                "
                [displayError]="isFieldInvalid('recipientBuilding')"
                errorMsg="{{
                  'error.invalidSymbolEnteredAllowed' | translate
                }} A-Z, a-z, А-Я, а-я, 0-9, -'./,()?">
              </ob-field-error-display>
              <ob-field-error-display
                *ngIf="isMaxLengthError && errorField === 'recipientBuilding'"
                [displayError]="isMaxLengthError"
                errorMsg="{{ 'error.transferGeneralLengthError' | translate }}">
              </ob-field-error-display>
            </div>
            <!-- Дом -->
            <!-- Квартира / офис -->
            <div class="col-dt-3 col-tb-3 col-mb-6 mb-16">
              <div class="form-floating">
                <input
                  #recipientApartment
                  formControlName="recipientApartment"
                  type="text"
                  [ngClass]="displayFieldClass('recipientApartment')"
                  class="form-control base-input"
                  id="recipientApartment"
                  placeholder="{{ 'default.apartment-office' | translate }}"
                  autocomplete="off"
                  (change)="
                    recipientApartment.value = recipientApartment.value.trim()
                  " />
                <label for="recipientApartment">{{
                  'default.apartment-office' | translate
                }}</label>
              </div>
              <ob-field-error-display
                *ngIf="
                  currentGroup
                    .get('recipientApartment')
                    .hasError('invalidSymbolLatin')
                "
                [displayError]="isFieldInvalid('recipientApartment')"
                errorMsg="{{
                  'error.invalidSymbolEnteredAllowed' | translate
                }} A-Z, a-z, 0-9, -'./,()?">
              </ob-field-error-display>
              <ob-field-error-display
                *ngIf="
                  currentGroup
                    .get('recipientApartment')
                    .hasError('invalidSymbolCyryillic')
                "
                [displayError]="isFieldInvalid('recipientApartment')"
                errorMsg="{{
                  'error.invalidSymbolEnteredAllowed' | translate
                }} A-Z, a-z, А-Я, а-я, 0-9, -'./,()?">
              </ob-field-error-display>
              <ob-field-error-display
                *ngIf="isMaxLengthError && errorField === 'recipientApartment'"
                [displayError]="isMaxLengthError"
                errorMsg="{{ 'error.transferGeneralLengthError' | translate }}">
              </ob-field-error-display>
            </div>
            <!-- Квартира / офис -->
            <!-- </div> -->
          </div>
        </section>
      </div>
      <!-- Step 2 -->

      <!-- Additional step -->
      <div *ngIf="currentStep === 2">
        <section class="currency-transfer__form" [formGroup]="currentGroup">
          <p class="currency-transfer__form-title mb-16">
            {{ 'operations.default.paymentToBudget' | translate }}
          </p>
          <div class="row p-24">
            <!-- Код типа операции -->
            <div class="col-dt-6 col-tb-6 col-mb-12" id="bootstrap-overrides">
              <ng-select
                formControlName="budgetOperationTypeCode"
                class="knp-cbc-select floating-label dropdown-large"
                placeholder="{{
                  'currencyControl.currencyTransfer.operation-type-code'
                    | translate
                }}"
                [clearable]="true"
                [ngClass]="displayFieldClass('budgetOperationTypeCode')"
                notFoundText="{{ 'default.not_found' | translate }}"
                id="budgetOperationTypeCode"
                [editableSearchTerm]="true"
                loadingText="{{ 'default.loading' | translate }}..."
                [loading]="isOperationTypeCodeLoading"
                typeToSearchText="{{ 'default.typeToSearchText' | translate }}"
                (change)="onBudgetCodeChanges($event, 'operation-type')">
                <ng-option
                  *ngFor="let item of operationTypeCodeList"
                  [value]="item">
                  <ob-knp
                    [knpCode]="item.mapCode"
                    [knpName]="item.valueRu"
                    searchTitle="{{
                      'currencyControl.currencyTransfer.operation-type-code'
                        | translate
                    }}"></ob-knp>
                </ng-option>
              </ng-select>
              <ob-field-error-display
                *ngIf="
                  currentGroup
                    .get('budgetOperationTypeCode')
                    .hasError('required')
                "
                [displayError]="isFieldInvalid('budgetOperationTypeCode')"
                errorMsg="{{ 'error.required' | translate }}">
              </ob-field-error-display>
            </div>
            <!-- Код типа операции -->
            <!-- Код бюджетной классификации (N4) -->
            <div class="col-dt-6 col-tb-6 col-mb-12 mb-16">
              <div class="form-floating">
                <input
                  #budgetCbc
                  formControlName="budgetCbc"
                  type="text"
                  [ngClass]="displayFieldClass('budgetCbc')"
                  class="form-control base-input"
                  id="budgetCbc"
                  placeholder="{{
                    'currencyControl.currencyTransfer.budget-cbc' | translate
                  }}"
                  autocomplete="off"
                  mask="00000000000000000000"
                  (change)="budgetCbc.value = budgetCbc.value.trim()" />
                <label for="budgetCbc">{{
                  'currencyControl.currencyTransfer.budget-cbc' | translate
                }}</label>
              </div>
              <ob-field-error-display
                *ngIf="currentGroup.get('budgetCbc').hasError('required')"
                [displayError]="isFieldInvalid('budgetCbc')"
                errorMsg="{{ 'error.required' | translate }}">
              </ob-field-error-display>
              <ob-field-error-display
                *ngIf="currentGroup.get('budgetCbc').hasError('mask')"
                [displayError]="isFieldInvalid('budgetCbc')"
                errorMsg="{{ 'error.minLengthError' | translate }}">
              </ob-field-error-display>
              <ob-field-error-display
                *ngIf="
                  currentGroup.get('budgetCbc').hasError('allZero') &&
                  !currentGroup.get('budgetCbc').hasError('mask')
                "
                [displayError]="isFieldInvalid('budgetCbc')"
                errorMsg="{{ 'error.filledIncorrectly' | translate }}">
              </ob-field-error-display>
            </div>
            <!-- Код бюджетной классификации (N4) -->
          </div>
          <div class="row p-24">
            <!-- Код ОКТМО (N5) -->
            <div class="col-dt-6 col-tb-6 col-mb-12 mb-16">
              <div class="form-floating">
                <input
                  #budgetOktmoCode
                  formControlName="budgetOktmoCode"
                  type="text"
                  [ngClass]="displayFieldClass('budgetOktmoCode')"
                  class="form-control base-input"
                  id="budgetOktmoCode"
                  placeholder="{{
                    'currencyControl.currencyTransfer.oktmo-code' | translate
                  }}"
                  autocomplete="off"
                  mask="00000000"
                  (change)="
                    budgetOktmoCode.value = budgetOktmoCode.value.trim()
                  " />
                <label for="budgetOktmoCode">{{
                  'currencyControl.currencyTransfer.oktmo-code' | translate
                }}</label>
              </div>
              <ob-field-error-display
                *ngIf="currentGroup.get('budgetOktmoCode').hasError('required')"
                [displayError]="isFieldInvalid('budgetOktmoCode')"
                errorMsg="{{ 'error.required' | translate }}">
              </ob-field-error-display>
              <ob-field-error-display
                *ngIf="currentGroup.get('budgetOktmoCode').hasError('mask')"
                [displayError]="isFieldInvalid('budgetOktmoCode')"
                errorMsg="{{ 'error.fieldLength8' | translate }}">
              </ob-field-error-display>
              <ob-field-error-display
                *ngIf="
                  currentGroup.get('budgetOktmoCode').hasError('allZero') &&
                  !currentGroup.get('budgetOktmoCode').hasError('mask')
                "
                [displayError]="isFieldInvalid('budgetOktmoCode')"
                errorMsg="{{ 'error.filledIncorrectly' | translate }}">
              </ob-field-error-display>
            </div>
            <!-- Код ОКТМО (N5) -->

            <!-- Основание налогового платежа (N6) -->
            <div
              class="col-dt-6 col-tb-6 col-mb-12"
              id="bootstrap-overrides-knp-cbc">
              <ng-select
                formControlName="budgetPaymentReason"
                class="knp-cbc-select floating-label dropdown-right"
                placeholder="{{
                  'currencyControl.currencyTransfer.budget-payment-reason'
                    | translate
                }}"
                [clearable]="true"
                [ngClass]="displayFieldClass('budgetPaymentReason')"
                notFoundText="{{ 'default.not_found' | translate }}"
                id="budgetPaymentReason"
                [editableSearchTerm]="true"
                loadingText="{{ 'default.loading' | translate }}..."
                [loading]="isForeignBanksLoading"
                typeToSearchText="{{ 'default.typeToSearchText' | translate }}"
                (change)="onBudgetCodeChanges($event, 'payment-reason')">
                <ng-option
                  *ngFor="let item of budgetPaymentReasonList"
                  [value]="item">
                  <ob-knp
                    [knpCode]="item.mapCode"
                    [knpName]="item.valueRu"
                    searchTitle="{{
                      'currencyControl.currencyTransfer.budget-payment-reason'
                        | translate
                    }}"></ob-knp>
                </ng-option>
              </ng-select>
              <ob-field-error-display
                *ngIf="
                  currentGroup.get('budgetPaymentReason').hasError('required')
                "
                [displayError]="isFieldInvalid('budgetPaymentReason')"
                errorMsg="{{ 'error.required' | translate }}">
              </ob-field-error-display>
            </div>
            <!-- Основание налогового платежа (N6) -->
          </div>
          <div class="row p-24">
            <!-- Налоговый период (N7) -->
            <div class="col-dt-6 col-tb-6 col-mb-12 mb-16">
              <div class="form-floating">
                <input
                  #budgetTaxPeriod
                  formControlName="budgetTaxPeriod"
                  type="text"
                  [ngClass]="displayFieldClass('budgetTaxPeriod')"
                  class="form-control base-input"
                  id="budgetTaxPeriod"
                  placeholder="{{
                    'currencyControl.currencyTransfer.tax-period' | translate
                  }}"
                  autocomplete="off"
                  [dropSpecialCharacters]="false"
                  mask="00.0000"
                  (change)="
                    budgetTaxPeriod.value = budgetTaxPeriod.value.trim()
                  " />
                <label for="budgetTaxPeriod">{{
                  'currencyControl.currencyTransfer.tax-period' | translate
                }}</label>
              </div>
              <ob-field-error-display
                *ngIf="currentGroup.get('budgetTaxPeriod').hasError('required')"
                [displayError]="isFieldInvalid('budgetTaxPeriod')"
                errorMsg="{{ 'error.required' | translate }}">
              </ob-field-error-display>
            </div>
            <!-- Налоговый период (N7) -->
            <!-- Номер налового документа (N8) -->
            <div class="col-dt-6 col-tb-6 col-mb-12 mb-16">
              <div class="form-floating">
                <input
                  #budgetPaymentDocNumber
                  formControlName="budgetPaymentDocNumber"
                  type="text"
                  [ngClass]="displayFieldClass('budgetPaymentDocNumber')"
                  class="form-control base-input"
                  id="budgetPaymentDocNumber"
                  placeholder="{{
                    'currencyControl.currencyTransfer.budget-docNum' | translate
                  }}"
                  autocomplete="off"
                  maxlength="15"
                  (change)="
                    budgetPaymentDocNumber.value =
                      budgetPaymentDocNumber.value.trim()
                  " />
                <label for="budgetPaymentDocNumber">{{
                  'currencyControl.currencyTransfer.budget-docNum' | translate
                }}</label>
              </div>
              <ob-field-error-display
                *ngIf="
                  currentGroup
                    .get('budgetPaymentDocNumber')
                    .hasError('required')
                "
                [displayError]="isFieldInvalid('budgetPaymentDocNumber')"
                errorMsg="{{ 'error.required' | translate }}">
              </ob-field-error-display>
              <ob-field-error-display
                *ngIf="
                  currentGroup.get('budgetPaymentDocNumber').hasError('pattern')
                "
                [displayError]="isFieldInvalid('budgetPaymentDocNumber')"
                errorMsg="{{ 'error.filledIncorrectly' | translate }}">
              </ob-field-error-display>
            </div>
            <!-- Номер налового документа (N8) -->
          </div>
          <div class="row p-24">
            <!-- Дата налогового документа (N9) -->
            <div class="col-dt-6 col-tb-6 col-mb-12 mb-16">
              <div class="form-floating" style="position: relative">
                <input
                  [ngClass]="displayFieldClass('budgetPaymentDocDate')"
                  type="text"
                  class="form-control base-input capitalize"
                  [required]=""
                  placeholder="{{
                    'currencyControl.currencyTransfer.budget-docDate'
                      | translate
                  }}"
                  formControlName="budgetPaymentDocDate"
                  bsDatepicker
                  (change)="onDateChange()"
                  [readonly]="true"
                  style="background-color: #fff"
                  [bsConfig]="{
                    customTodayClass: 'custom-today-class',
                    isAnimated: true,
                    containerClass: 'payments-calendar',
                    showWeekNumbers: false,
                    startView: 'day',
                    minMode: 'day',
                    maxDate: passportMaxDate,
                    dateInputFormat: 'DD.MM.YYYY'
                  }"
                  #dpBudget="bsDatepicker" />
                <span class="icon-calendar" (click)="dpBudget.toggle()">
                  <img src="./assets/icons/ic_calendar2.svg" alt="" />
                </span>
                <label for="floatingInput">{{
                  'currencyControl.currencyTransfer.budget-docDate' | translate
                }}</label>
              </div>
              <ob-field-error-display
                *ngIf="
                  this.currentGroup
                    .get('budgetPaymentDocDate')
                    .hasError('required')
                "
                [displayError]="isFieldInvalid('budgetPaymentDocDate')"
                errorMsg="{{ 'error.required' | translate }}">
              </ob-field-error-display>
            </div>
            <!-- Дата налогового документа (N9) -->
            <!-- Тип налового платежа (N10) -->
            <div
              class="col-dt-6 col-tb-6 col-mb-12"
              id="bootstrap-overrides-knp-cbc">
              <ng-select
                formControlName="budgetPaymentType"
                class="knp-cbc-select floating-label dropdown-right"
                placeholder="{{
                  'currencyControl.currencyTransfer.budget-payment-type'
                    | translate
                }}"
                [clearable]="true"
                [ngClass]="displayFieldClass('budgetPaymentType')"
                notFoundText="{{ 'default.not_found' | translate }}"
                id="budgetPaymentType"
                [editableSearchTerm]="true"
                loadingText="{{ 'default.loading' | translate }}..."
                [loading]="isForeignBanksLoading"
                typeToSearchText="{{ 'default.typeToSearchText' | translate }}"
                (change)="onBudgetCodeChanges($event, 'payment-type')">
                <ng-option
                  *ngFor="let item of budgetPaymentTypeList"
                  [value]="item">
                  <ob-knp
                    [knpCode]="item.mapCode"
                    [knpName]="item.valueRu"
                    searchTitle="{{
                      'currencyControl.currencyTransfer.budget-payment-type'
                        | translate
                    }}"></ob-knp>
                </ng-option>
              </ng-select>
              <ob-field-error-display
                *ngIf="
                  currentGroup.get('budgetPaymentType').hasError('required')
                "
                [displayError]="isFieldInvalid('budgetPaymentType')"
                errorMsg="{{ 'error.required' | translate }}">
              </ob-field-error-display>
            </div>
            <!-- Тип налового платежа (N10) -->
          </div>
        </section>
      </div>
      <!-- Additional step -->

      <!-- Step 3 or 4 -->
      <div *ngIf="currentStep === 3">
        <section class="currency-transfer__form" [formGroup]="currentGroup">
          <p class="currency-transfer__form-title mb-16">
            {{ 'operations.default.bankRecipient' | translate }} (57)
          </p>

          <ng-template
            [ngIf]="
              transferCurrency === 'USD' ||
              transferCurrency === 'GBP' ||
              transferCurrency === 'CNY' ||
              transferCurrency === 'EUR'
            ">
            <div
              class="flex gap-3 currency-transfer__switch-btns mb-16"
              *ngIf="transferCurrency === 'USD' || transferCurrency === 'GBP'">
              <div
                class="currency-transfer__switch-btn"
                [ngClass]="{ selected: isSwift }"
                (click)="onSwiftClick()">
                <p>SWIFT</p>
              </div>
              <div
                class="currency-transfer__switch-btn"
                *ngIf="transferCurrency === 'USD'"
                [ngClass]="{ selected: !isSwift }"
                (click)="onNotSwiftClick()">
                <p>Fedwire Routing Number</p>
              </div>
              <div
                class="currency-transfer__switch-btn"
                *ngIf="transferCurrency === 'GBP'"
                [ngClass]="{ selected: !isSwift }"
                (click)="onNotSwiftClick()">
                <p>Sort Code</p>
              </div>
            </div>
            <div class="row" *ngIf="isSwift">
              <!-- SWIFT -->
              <div
                class="col-dt-6 col-tb-6 col-mb-12"
                id="bootstrap-overrides-region">
                <ng-select
                  formControlName="swift"
                  [virtualScroll]="true"
                  class="custom-select floating-label"
                  placeholder="{{
                    'currencyControl.currencyTransfer.enterSwift' | translate
                  }}"
                  [clearable]="true"
                  [ngClass]="displayFieldClass('swift')"
                  notFoundText="{{ 'default.not_found' | translate }}"
                  id="swift"
                  [editableSearchTerm]="true"
                  loadingText="{{ 'default.loading' | translate }}..."
                  (change)="onBankChange($event)"
                  (scroll)="onScroll($event)"
                  [loading]="isForeignBanksLoading"
                  typeToSearchText="{{
                    'default.typeToSearchText' | translate
                  }}"
                  (scrollToEnd)="loadMoreForeignBanks()"
                  [typeahead]="foreignBankSubscription$"
                  (open)="onForeignBanksOpen()">
                  <ng-option *ngFor="let bank of bankList" [value]="bank">
                    <div>
                      <p class="unk-text-bold">{{ bank.bic }}</p>
                      <p class="unk-text-gray">{{ bank.bankName }}</p>
                    </div>
                  </ng-option>
                </ng-select>
                <ob-field-error-display
                  *ngIf="currentGroup.get('swift').hasError('required')"
                  [displayError]="isFieldInvalid('swift')"
                  errorMsg="{{ 'error.required' | translate }}">
                </ob-field-error-display>
                <ob-field-error-display
                  *ngIf="currentGroup.get('swift').hasError('pattern')"
                  [displayError]="isFieldInvalid('swift')"
                  errorMsg="{{
                    'error.invalidSymbolEnteredAllowed' | translate
                  }} A-Z, 0-9">
                </ob-field-error-display>
              </div>
              <!-- SWIFT -->
              <!-- Код филиала банка бенефициара -->
              <div
                class="col-dt-6 col-tb-6 col-mb-12 mb-16"
                *ngIf="selectedCountry.code === 'CA'">
                <div class="form-floating">
                  <input
                    #transitCode
                    formControlName="transitCode"
                    type="text"
                    [ngClass]="displayFieldClass('transitCode')"
                    class="form-control base-input"
                    id="transitCode"
                    placeholder="{{
                      'currencyControl.currencyTransfer.branchCode' | translate
                    }}"
                    autocomplete="off"
                    mask="00000"
                    (change)="transitCode.value = transitCode.value.trim()" />
                  <label for="transitCode">{{
                    'currencyControl.currencyTransfer.branchCode' | translate
                  }}</label>
                </div>
                <ob-field-error-display
                  *ngIf="currentGroup.get('transitCode').hasError('required')"
                  [displayError]="isFieldInvalid('transitCode')"
                  errorMsg="{{ 'error.required' | translate }}">
                </ob-field-error-display>
              </div>
              <!-- Код филиала банка бенефициара -->
            </div>
            <ng-template
              [ngIf]="
                currentGroup.get('swift').value && recipientBankName && isSwift
              ">
              <div class="row pd-10 mt-16">
                <div
                  class="description-section-info col-dt-10 col-tb-10 col-mb-12">
                  <div class="description-section-detail">
                    <p class="description-section-detail__content">
                      {{ recipientBankName }}
                    </p>
                  </div>
                </div>
              </div>
            </ng-template>
            <!-- Банк посредник -->
            <div class="row flex-column mt-24" *ngIf="isSwift">
              <div
                class="currency-transfer-general-term col-dt-6 col-tb-6 col-mb-12 mt-16">
                <div class="currency-transfer-general-term__toggle">
                  <div class="material-switch">
                    <input
                      class="form-check-input"
                      type="checkbox"
                      role="switch"
                      id="isMiddleBank"
                      formControlName="isMiddleBank" />
                    <label class="form-check-label" for="isMiddleBank"></label>
                  </div>
                </div>
                <div class="currency-transfer-general-term__text">
                  <p class="currency-transfer-autofill__dark">
                    {{
                      'currencyControl.currencyTransfer.middleBankPlaceholder'
                        | translate
                    }}
                  </p>
                </div>
              </div>
            </div>
            <ng-template [ngIf]="currentGroup.get('isMiddleBank').value">
              <div
                class="col-dt-6 col-tb-6 col-mb-12 mt-16"
                id="bootstrap-overrides-region">
                <ng-select
                  formControlName="swiftMiddleBank"
                  [virtualScroll]="true"
                  class="custom-select floating-label"
                  placeholder="{{
                    'currencyControl.currencyTransfer.enterSwift' | translate
                  }}"
                  [clearable]="true"
                  [ngClass]="displayFieldClass('swiftMiddleBank')"
                  notFoundText="{{ 'default.not_found' | translate }}"
                  id="swiftMiddleBank"
                  [editableSearchTerm]="true"
                  loadingText="{{ 'default.loading' | translate }}..."
                  (scroll)="onScroll($event)"
                  [loading]="isForeignBanksLoading"
                  typeToSearchText="{{
                    'default.typeToSearchText' | translate
                  }}"
                  (scrollToEnd)="loadMoreForeignBanks()"
                  [typeahead]="foreignBankSubscription$"
                  (open)="onForeignBanksOpen()"
                  (change)="onMiddleBankChange($event)"
                  (search)="onMiddleBankSearch($event)">
                  <ng-option *ngFor="let bank of bankList" [value]="bank">
                    <div>
                      <p class="unk-text-bold">{{ bank.bic }}</p>
                      <p class="unk-text-gray">
                        {{ bank.bankName || bank.name }}
                      </p>
                    </div>
                  </ng-option>
                </ng-select>
                <ob-field-error-display
                  *ngIf="
                    currentGroup.get('swiftMiddleBank').hasError('pattern')
                  "
                  [displayError]="isFieldInvalid('swiftMiddleBank')"
                  errorMsg="{{
                    'error.invalidSymbolEnteredAllowed' | translate
                  }} A-Z, 0-9">
                </ob-field-error-display>
              </div>
            </ng-template>
            <ng-template
              [ngIf]="
                currentGroup.get('isMiddleBank').value &&
                currentGroup.get('swiftMiddleBank').value &&
                middleBankName &&
                isSwift
              ">
              <div class="row pd-10 mt-16">
                <div
                  class="description-section-info col-dt-10 col-tb-10 col-mb-12">
                  <div class="description-section-detail">
                    <p class="description-section-detail__content">
                      {{ middleBankName }}
                    </p>
                  </div>
                </div>
              </div>
            </ng-template>
            <!-- Банк посредник -->
            <!-- Наименование банка -->
            <div class="col-dt-12 col-tb-12 col-mb-12 mb-16" *ngIf="!isSwift">
              <div class="form-floating">
                <input
                  #recipientBankName
                  formControlName="recipientBankName"
                  type="text"
                  [ngClass]="displayFieldClass('recipientBankName')"
                  class="form-control base-input"
                  id="recipientBankName"
                  placeholder="{{
                    'currencyControl.currencyTransfer.bankName' | translate
                  }}"
                  autocomplete="off"
                  (change)="
                    recipientBankName.value = recipientBankName.value.trim()
                  " />
                <label for="recipientBankName">{{
                  'currencyControl.currencyTransfer.bankName' | translate
                }}</label>
              </div>
              <ob-field-error-display
                *ngIf="
                  currentGroup.get('recipientBankName').hasError('required')
                "
                [displayError]="isFieldInvalid('recipientBankName')"
                errorMsg="{{ 'error.required' | translate }}">
              </ob-field-error-display>
              <ob-field-error-display
                *ngIf="
                  currentGroup
                    .get('recipientBankName')
                    .hasError('invalidSymbolLatin')
                "
                [displayError]="isFieldInvalid('recipientBankName')"
                errorMsg="{{
                  'error.invalidSymbolEnteredAllowed' | translate
                }} A-Z, a-z, 0-9, -'./,()?">
              </ob-field-error-display>
              <ob-field-error-display
                *ngIf="
                  currentGroup
                    .get('recipientBankName')
                    .hasError('invalidSymbolCyryillic')
                "
                [displayError]="isFieldInvalid('recipientBankName')"
                errorMsg="{{
                  'error.invalidSymbolEnteredAllowed' | translate
                }} A-Z, a-z, А-Я, а-я, 0-9, -'./,()?">
              </ob-field-error-display>
            </div>
            <!-- Наименование банка -->
            <div class="row g-24 mb-24" *ngIf="!isSwift">
              <!-- Страна -->
              <div
                class="col-dt-6 col-tb-6 col-mb-12 mb-16"
                id="bootstrap-overrides-region">
                <ng-select
                  formControlName="recipientBankCountry"
                  class="custom-select floating-label"
                  placeholder="{{ 'default.country' | translate }}"
                  [clearable]="true"
                  [ngClass]="displayFieldClass('recipientBankCountry')"
                  notFoundText="{{ 'default.not_found' | translate }}"
                  id="recipientBankCountry"
                  [editableSearchTerm]="true"
                  loadingText="{{ 'default.loading' | translate }}..."
                  (change)="onCountryChange($event, 'bank')"
                  [loading]="countryListLoading">
                  <ng-option
                    *ngFor="let country of countryList"
                    [value]="country">
                    <p>{{ country.name }}</p>
                  </ng-option>
                </ng-select>
                <ob-field-error-display
                  *ngIf="
                    currentGroup
                      .get('recipientBankCountry')
                      .hasError('required')
                  "
                  [displayError]="isFieldInvalid('recipientBankCountry')"
                  errorMsg="{{ 'error.required' | translate }}">
                </ob-field-error-display>
              </div>
              <!-- Страна -->
              <!-- Адрес -->
              <div class="col-dt-6 col-tb-6 col-mb-6 mb-16">
                <div class="form-floating">
                  <input
                    #recipientBankAddress
                    formControlName="recipientBankAddress"
                    type="text"
                    [ngClass]="displayFieldClass('recipientBankAddress')"
                    class="form-control base-input"
                    id="recipientBankAddress"
                    placeholder="{{ 'default.address' | translate }}"
                    autocomplete="off"
                    (change)="
                      recipientBankAddress.value =
                        recipientBankAddress.value.trim()
                    " />
                  <label for="recipientBankAddress">{{
                    'default.address' | translate
                  }}</label>
                </div>
                <ob-field-error-display
                  *ngIf="
                    currentGroup
                      .get('recipientBankAddress')
                      .hasError('required')
                  "
                  [displayError]="isFieldInvalid('recipientBankAddress')"
                  errorMsg="{{ 'error.required' | translate }}">
                </ob-field-error-display>
                <ob-field-error-display
                  *ngIf="
                    currentGroup
                      .get('recipientBankAddress')
                      .hasError('invalidSymbolLatin')
                  "
                  [displayError]="isFieldInvalid('recipientBankAddress')"
                  errorMsg="{{
                    'error.invalidSymbolEnteredAllowed' | translate
                  }} A-Z, a-z, 0-9, -'./,()?">
                </ob-field-error-display>
                <ob-field-error-display
                  *ngIf="
                    currentGroup
                      .get('recipientBankAddress')
                      .hasError('invalidSymbolCyryillic')
                  "
                  [displayError]="isFieldInvalid('recipientBankAddress')"
                  errorMsg="{{
                    'error.invalidSymbolEnteredAllowed' | translate
                  }} A-Z, a-z, А-Я, а-я, 0-9, -'./,()?">
                </ob-field-error-display>
              </div>
              <!-- Адрес -->
            </div>
          </ng-template>

          <ng-template
            [ngIf]="transferCurrency === 'RUB' || transferCurrency === 'KGS'">
            <div class="row">
              <!-- БИК -->
              <div
                class="col-dt-6 col-tb-6 col-mb-12"
                id="bootstrap-overrides-region">
                <ng-select
                  formControlName="swift"
                  [virtualScroll]="true"
                  class="custom-select floating-label"
                  placeholder="{{ 'operations.payments.bic' | translate }}"
                  [clearable]="true"
                  [ngClass]="displayFieldClass('swift')"
                  notFoundText="{{ 'default.not_found' | translate }}"
                  id="swift"
                  [editableSearchTerm]="true"
                  loadingText="{{ 'default.loading' | translate }}..."
                  (change)="onBankChange($event)"
                  (scroll)="onScroll($event)"
                  [loading]="isForeignBanksLoading"
                  typeToSearchText="{{
                    'default.typeToSearchText' | translate
                  }}"
                  (scrollToEnd)="loadMoreForeignBanks()"
                  [typeahead]="foreignBankSubscription$"
                  (open)="onForeignBanksOpen()">
                  <ng-option *ngFor="let bank of bankList" [value]="bank">
                    <div>
                      <p class="unk-text-bold">{{ bank.bic }}</p>
                      <p class="unk-text-gray">{{ bank.bankName }}</p>
                    </div>
                  </ng-option>
                </ng-select>
                <ob-field-error-display
                  *ngIf="currentGroup.get('swift').hasError('required')"
                  [displayError]="isFieldInvalid('swift')"
                  errorMsg="{{ 'error.required' | translate }}">
                </ob-field-error-display>
                <ob-field-error-display
                  *ngIf="currentGroup.get('swift').hasError('pattern')"
                  [displayError]="isFieldInvalid('swift')"
                  errorMsg="{{
                    'error.invalidSymbolEnteredAllowed' | translate
                  }} A-Z, 0-9">
                </ob-field-error-display>
              </div>
              <ng-template
                [ngIf]="
                  currentGroup.get('swift').value &&
                  recipientBankName &&
                  isSwift
                ">
                <div class="row description-section-block">
                  <div
                    class="description-section-info col-dt-10 col-tb-10 col-mb-12">
                    <div class="description-section-detail">
                      <p class="description-section-detail__content">
                        {{ recipientBankName }}
                      </p>
                    </div>
                  </div>
                </div>
              </ng-template>
              <!-- БИК -->
            </div>
          </ng-template>

          <!-- Детали -->
          <p class="currency-transfer__form-title mb-16 mt-40">
            {{ 'products.default.details' | translate }}
          </p>
          <div class="row">
            <!-- КНП -->
            <div
              class="col-dt-6 col-tb-6 col-mb-12 mb-16"
              id="bootstrap-overrides">
              <div
                class="form-floating"
                [tooltip]="tooltipKnp"
                [delay]="100"
                #pop3="bs-tooltip"
                (click)="pop3.hide()"
                (keypress)="pop3.hide()"
                [isDisabled]="isSearchableKnp">
                <ng-select
                  formControlName="knp"
                  class="knp-cbc-select floating-label dropdown-large"
                  [ngClass]="displayFieldClass('knp')"
                  [searchable]="isSearchableKnp"
                  [editableSearchTerm]="true"
                  (search)="onSearchKnp($event)"
                  (change)="onChangeKnp($event)"
                  notFoundText="{{ 'error.empty-data' | translate }}"
                  placeholder="{{ 'operations.default.knpLong' | translate }}"
                  required
                  (open)="onOpenKnp()"
                  (close)="onCloseKnp()"
                  (blur)="onCloseKnp()"
                  id="knp"
                  loadingText="{{ 'default.loading' | translate }}...">
                  <ng-option *ngFor="let knpItem of knpList" [value]="knpItem">
                    <ob-knp
                      [knpCode]="knpItem.code"
                      [knpName]="knpItem.name"
                      searchTitle="{{
                        'operations.default.knpLong' | translate
                      }}"></ob-knp>
                  </ng-option>
                </ng-select>
              </div>
              <ng-template #tooltipKnp>
                <ob-tooltip [type]="'knp'"></ob-tooltip>
              </ng-template>
              <ob-field-error-display
                *ngIf="currentGroup.get('knp').hasError('required')"
                [displayError]="isFieldInvalid('knp')"
                errorMsg="{{ 'error.required' | translate }}">
              </ob-field-error-display>
              <!-- <ob-field-error-display
                        *ngIf="
                          isKnpInvalid || counteragentFormControl.knp.errors?.pattern
                        "
                        [displayError]="isFieldInvalid('knp')"
                        errorMsg="{{ 'error.filledIncorrectly' | translate }}"
                      >
                      </ob-field-error-display>
                      <ob-field-error-display
                        *ngIf="counteragentFormControl.knp.errors?.invalidSymbol"
                        [displayError]="isFieldInvalid('knp')"
                        errorMsg="{{ 'error.symbol' | translate }}"
                      >
                      </ob-field-error-display> -->
            </div>
            <!-- КНП -->
            <!-- Код валютной операции -->
            <div
              class="col-dt-6 col-tb-6 col-mb-12 mb-16"
              id="bootstrap-overrides-knp-cbc"
              *ngIf="transferCurrency === 'RUB'">
              <div class="form-floating">
                <ng-select
                  formControlName="operationCodeRub"
                  class="knp-cbc-select floating-label dropdown-right"
                  [ngClass]="displayFieldClass('operationCodeRub')"
                  [searchable]="isSearchableOperationCode"
                  [editableSearchTerm]="true"
                  notFoundText="{{ 'error.empty-data' | translate }}"
                  placeholder="{{
                    'currencyControl.currencyTransfer.operationCode' | translate
                  }}"
                  required
                  (change)="onOperationCodeChanges($event)"
                  (open)="onOpenOperationCode()"
                  (close)="onCloseOperationCode()"
                  id="operationCodeRub"
                  loadingText="{{ 'default.loading' | translate }}...">
                  <ng-option
                    *ngFor="let codeItem of operationCodeRubList"
                    [value]="codeItem">
                    <ob-knp
                      [knpCode]="codeItem.code"
                      [knpName]="codeItem.name"></ob-knp>
                  </ng-option>
                </ng-select>
              </div>
              <ob-field-error-display
                *ngIf="
                  currentGroup.get('operationCodeRub').hasError('required')
                "
                [displayError]="isFieldInvalid('operationCodeRub')"
                errorMsg="{{ 'error.required' | translate }}">
              </ob-field-error-display>
            </div>
            <!-- Код валютной операции -->
            <!-- Код назначения (KGS) -->
            <div
              class="col-dt-6 col-tb-6 col-mb-12 mb-16"
              id="bootstrap-overrides-knp-cbc"
              *ngIf="transferCurrency === 'KGS'">
              <div class="form-floating">
                <ng-select
                  formControlName="purposeCodeKGS"
                  class="knp-cbc-select floating-label dropdown-right"
                  [ngClass]="displayFieldClass('purposeCodeKGS')"
                  [searchable]="isSearchableOperationCode"
                  [editableSearchTerm]="true"
                  notFoundText="{{ 'error.empty-data' | translate }}"
                  placeholder="{{
                    'currencyControl.currencyTransfer.purposeCode' | translate
                  }} (KGS)"
                  required
                  (change)="onPurposeCodeChange($event, 'KGS')"
                  (open)="onOpenOperationCode()"
                  (close)="onCloseOperationCode()"
                  id="operationCodeRub"
                  loadingText="{{ 'default.loading' | translate }}...">
                  <ng-option
                    *ngFor="let codeItem of purposeCodeListKGS"
                    [value]="codeItem">
                    <ob-knp
                      [knpCode]="codeItem.code"
                      [knpName]="codeItem.name"></ob-knp>
                  </ng-option>
                </ng-select>
              </div>
              <!-- <ob-field-error-display
                        *ngIf="counteragentFormControl.knp.errors?.required"
                        [displayError]="isFieldInvalid('knp')"
                        errorMsg="{{ 'error.required' | translate }}"
                      >
                      </ob-field-error-display>
                      <ob-field-error-display
                        *ngIf="
                          isKnpInvalid || counteragentFormControl.knp.errors?.pattern
                        "
                        [displayError]="isFieldInvalid('knp')"
                        errorMsg="{{ 'error.filledIncorrectly' | translate }}"
                      >
                      </ob-field-error-display>
                      <ob-field-error-display
                        *ngIf="counteragentFormControl.knp.errors?.invalidSymbol"
                        [displayError]="isFieldInvalid('knp')"
                        errorMsg="{{ 'error.symbol' | translate }}"
                      >
                      </ob-field-error-display> -->
            </div>
            <!-- Код назначения (KGS) -->
            <!-- Код назначения (CNY) -->
            <div
              class="col-dt-6 col-tb-6 col-mb-12 mb-16"
              id="bootstrap-overrides-knp-cbc"
              *ngIf="transferCurrency === 'CNY'">
              <div class="form-floating">
                <ng-select
                  formControlName="purposeCodeCNY"
                  class="knp-cbc-select floating-label dropdown-right"
                  [ngClass]="displayFieldClass('purposeCodeCNY')"
                  [searchable]="isSearchableOperationCode"
                  [editableSearchTerm]="true"
                  notFoundText="{{ 'error.empty-data' | translate }}"
                  placeholder="{{
                    'currencyControl.currencyTransfer.purposeCode' | translate
                  }} (CNY)"
                  required
                  (change)="onPurposeCodeChange($event, 'CNY')"
                  (open)="onOpenOperationCode()"
                  (close)="onCloseOperationCode()"
                  id="operationCodeRub"
                  loadingText="{{ 'default.loading' | translate }}...">
                  <ng-option
                    *ngFor="let codeItem of purposeCodeListCNY"
                    [value]="codeItem">
                    <ob-knp
                      [knpCode]="codeItem.mapCode"
                      [knpName]="codeItem.valueRu"></ob-knp>
                  </ng-option>
                </ng-select>
              </div>
              <!-- <ob-field-error-display
                        *ngIf="counteragentFormControl.knp.errors?.required"
                        [displayError]="isFieldInvalid('knp')"
                        errorMsg="{{ 'error.required' | translate }}"
                      >
                      </ob-field-error-display>
                      <ob-field-error-display
                        *ngIf="
                          isKnpInvalid || counteragentFormControl.knp.errors?.pattern
                        "
                        [displayError]="isFieldInvalid('knp')"
                        errorMsg="{{ 'error.filledIncorrectly' | translate }}"
                      >
                      </ob-field-error-display>
                      <ob-field-error-display
                        *ngIf="counteragentFormControl.knp.errors?.invalidSymbol"
                        [displayError]="isFieldInvalid('knp')"
                        errorMsg="{{ 'error.symbol' | translate }}"
                      >
                      </ob-field-error-display> -->
            </div>
            <!-- Код назначения (CNY) -->

            <!-- Код назначения (UAE) -->
            <div
              class="col-dt-6 col-tb-6 col-mb-12 mb-16"
              id="bootstrap-overrides-knp-cbc"
              *ngIf="selectedCountry.code === 'AE'">
              <div class="form-floating">
                <ng-select
                  formControlName="purposeCodeUAE"
                  class="knp-cbc-select floating-label"
                  [class.dropdown-right]="
                    !['RUB', 'CNY', 'KGS'].includes(transferCurrency)
                  "
                  [ngClass]="displayFieldClass('purposeCodeUAE')"
                  [searchable]="true"
                  [editableSearchTerm]="true"
                  notFoundText="{{ 'error.empty-data' | translate }}"
                  placeholder="{{
                    'currencyControl.currencyTransfer.purposeCode' | translate
                  }} (UAE)"
                  required
                  (change)="onPurposeCodeChange($event, 'AE')"
                  id="operationCodeRub"
                  loadingText="{{ 'default.loading' | translate }}...">
                  <ng-option
                    *ngFor="let codeItem of purposeCodeUAEList"
                    [value]="codeItem">
                    <ob-knp
                      [knpCode]="codeItem.mapCode"
                      [knpName]="codeItem.valueRu"></ob-knp>
                  </ng-option>
                </ng-select>
              </div>
              <!-- <ob-field-error-display
                        *ngIf="counteragentFormControl.knp.errors?.required"
                        [displayError]="isFieldInvalid('knp')"
                        errorMsg="{{ 'error.required' | translate }}"
                      >
                      </ob-field-error-display>
                      <ob-field-error-display
                        *ngIf="
                          isKnpInvalid || counteragentFormControl.knp.errors?.pattern
                        "
                        [displayError]="isFieldInvalid('knp')"
                        errorMsg="{{ 'error.filledIncorrectly' | translate }}"
                      >
                      </ob-field-error-display>
                      <ob-field-error-display
                        *ngIf="counteragentFormControl.knp.errors?.invalidSymbol"
                        [displayError]="isFieldInvalid('knp')"
                        errorMsg="{{ 'error.symbol' | translate }}"
                      >
                      </ob-field-error-display> -->
            </div>
            <!-- Код назначения (UAE) -->
          </div>
          <ng-template [ngIf]="knpDescription">
            <div class="row pd-10">
              <div
                class="description-section-info col-dt-10 col-tb-10 col-mb-12 mb-24"
                style="height: 100%">
                <div class="description-section-detail">
                  <p class="description-section-detail__content">
                    {{ knpDescription }}
                  </p>
                </div>
              </div>
            </div>
          </ng-template>
          <!-- Назначение платежа -->
          <div
            class="col-dt-12 col-tb-12 col-mb-12 currency-transfer-inputs__element-textarea">
            <div
              class="form-floating"
              [tooltip]="tooltipPurpose"
              [delay]="100"
              #pop2="bs-tooltip"
              [isDisabled]="isSearchableKnp || isDisablePurposeTooltip"
              (click)="pop2.hide()"
              (keypress)="pop2.hide()">
              <textarea
                class="form-control currency-transfer-inputs__textarea"
                [ngClass]="displayFieldClass('purpose')"
                placeholder="{{
                  'operations.countragent.purpose' | translate
                }}' (70)'"
                id="floatingTextarea"
                formControlName="purpose"
                (blur)="onTextareaBlur()"
                (focus)="onTextareaFocus()"
                #textPurpose
                [rows]="getHeight(textPurpose.value) || 2"
                maxlength="{{ transferCurrency === 'RUB' ? 120 : 140 }}"
                (click)="pop2.hide()"
                (mouseenter)="enableTooltip('purpose')"
                (mouseover)="enableTooltip('purpose')">
              </textarea>
              <label
                class="currency-transfer-inputs__textarea-label"
                for="floatingTextarea"
                >{{ 'operations.countragent.purpose' | translate }} (70)
              </label>
            </div>
            <ng-template #tooltipPurpose>
              <ob-tooltip [type]="'purpose'"></ob-tooltip>
            </ng-template>
            <div class="currency-transfer-inputs__textarea-bottom mb-16">
              <div>
                <ob-field-error-display
                  *ngIf="currentGroup.get('purpose').errors?.required"
                  [displayError]="isFieldInvalid('purpose')"
                  errorMsg="{{ 'error.required' | translate }}">
                </ob-field-error-display>
                <ob-field-error-display
                  *ngIf="currentGroup.get('purpose').errors?.maxlength"
                  [displayError]="isFieldInvalid('purpose')"
                  errorMsg="{{ 'error.purpose' | translate }}">
                </ob-field-error-display>
                <ob-field-error-display
                  *ngIf="
                    currentGroup.get('purpose').hasError('invalidSymbolLatin')
                  "
                  [displayError]="isFieldInvalid('purpose')"
                  errorMsg="{{
                    'error.invalidSymbolEnteredAllowed' | translate
                  }} A-Z, a-z, 0-9, -'./,()?">
                </ob-field-error-display>
                <ob-field-error-display
                  *ngIf="
                    currentGroup
                      .get('purpose')
                      .hasError('invalidSymbolCyryillic')
                  "
                  [displayError]="isFieldInvalid('purpose')"
                  errorMsg="{{
                    'error.invalidSymbolEnteredAllowed' | translate
                  }} A-Z, a-z, А-Я, а-я, 0-9, -'./,()?">
                </ob-field-error-display>
              </div>
              <p class="currency-transfer-inputs__textarea-length">
                {{ textPurpose.value.length }}/{{
                  transferCurrency === 'RUB' ? 120 : 140
                }}
              </p>
            </div>
          </div>
          <!-- Назначение платежа -->
          <!-- Информация получателю (72) -->
          <div
            class="col-dt-12 col-tb-12 col-mb-12 currency-transfer-inputs__element-textarea">
            <div class="form-floating">
              <textarea
                class="form-control currency-transfer-inputs__textarea"
                [ngClass]="displayFieldClass('infoToRecipient')"
                placeholder="{{
                  'currencyControl.currencyTransfer.infoToRecipient' | translate
                }}"
                id="floatingTextarea"
                formControlName="infoToRecipient"
                (blur)="onTextareaBlur()"
                (focus)="onTextareaFocus()"
                #infoToRecipient
                [rows]="getHeight(infoToRecipient.value) || 2"
                maxlength="{{ transferCurrency === 'RUB' ? 63 : 194 }}">
              </textarea>
              <label
                class="currency-transfer-inputs__textarea-label"
                for="floatingTextarea"
                >{{
                  'currencyControl.currencyTransfer.infoToRecipient' | translate
                }}</label
              >
            </div>
            <div class="currency-transfer-inputs__textarea-bottom mb-16">
              <div>
                <ob-field-error-display
                  *ngIf="currentGroup.get('infoToRecipient').errors?.required"
                  [displayError]="isFieldInvalid('infoToRecipient')"
                  errorMsg="{{ 'error.required' | translate }}">
                </ob-field-error-display>
                <ob-field-error-display
                  *ngIf="currentGroup.get('infoToRecipient').errors?.maxlength"
                  [displayError]="isFieldInvalid('infoToRecipient')"
                  errorMsg="{{ 'error.purpose' | translate }}">
                </ob-field-error-display>
                <ob-field-error-display
                  *ngIf="
                    currentGroup
                      .get('infoToRecipient')
                      .hasError('invalidSymbolLatin')
                  "
                  [displayError]="isFieldInvalid('infoToRecipient')"
                  errorMsg="{{
                    'error.invalidSymbolEnteredAllowed' | translate
                  }} A-Z, a-z, 0-9, -'./,()?">
                </ob-field-error-display>
                <ob-field-error-display
                  *ngIf="
                    currentGroup
                      .get('infoToRecipient')
                      .hasError('invalidSymbolCyryillic')
                  "
                  [displayError]="isFieldInvalid('infoToRecipient')"
                  errorMsg="{{
                    'error.invalidSymbolEnteredAllowed' | translate
                  }} A-Z, a-z, А-Я, а-я, 0-9, -'./,()?">
                </ob-field-error-display>
              </div>
              <p class="currency-transfer-inputs__textarea-length">
                {{ infoToRecipient.value.length }}/{{
                  transferCurrency === 'RUB' ? 63 : 194
                }}
              </p>
            </div>
          </div>
          <!-- Информация получателю (72) -->

          <!-- Обработать перевод сегодня -->
          <div class="row flex-column mb-40">
            <div
              class="currency-transfer-general-term col-dt-6 col-tb-6 col-mb-12 mt-16">
              <div class="currency-transfer-general-term__toggle">
                <div class="material-switch">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    role="switch"
                    id="switch-quick-payment"
                    formControlName="urgent" />
                  <label
                    class="form-check-label"
                    for="switch-quick-payment"></label>
                </div>
              </div>
              <div class="currency-transfer-general-term__text">
                <p class="currency-transfer-autofill__dark">
                  {{
                    'currencyControl.currencyTransfer.urgentToday' | translate
                  }}
                </p>
                <!-- <p class="currency-transfer-autofill__secondary">
                            {{ 'operations.countragent.urgentInfo' | translate }}
                        </p> -->
              </div>
            </div>
          </div>
          <!-- Обработать перевод сегодня -->
          <p class="currency-transfer__form-title mb-16">
            {{
              'currencyControl.currencyTransfer.comissionAccount' | translate
            }}
          </p>
          <div class="col-dt-6 col-tb-6 col-mb-12">
            <ng-select
              formControlName="comissionAccount"
              class="custom-select account-withdraw"
              [searchable]="false"
              [clearable]="false"
              placeholder="{{
                'currencyControl.currencyTransfer.comissionAccount' | translate
              }}"
              [ngClass]="displayFieldClass('comissionAccount')"
              notFoundText="{{ 'error.empty-data' | translate }}"
              required
              dropdownPosition="bottom"
              id="comissionAccount"
              loadingText="{{ 'default.loading' | translate }}...">
              <ng-option
                *ngFor="let account of accountListKZT"
                [value]="account?.iban">
                <ob-select-account
                  [description]="account.iban"
                  [title]="account.actualBalance"
                  [icon]="getIcon(account.currency)"
                  [currency]="account.currency"></ob-select-account>
              </ng-option>
            </ng-select>
            <ob-field-error-display
              *ngIf="currentGroup.get('comissionAccount').hasError('required')"
              [displayError]="isFieldInvalid('comissionAccount')"
              errorMsg="{{ 'error.account_not_selected' | translate }}">
            </ob-field-error-display>
          </div>
        </section>
      </div>
      <!-- Step 3 or 4 -->
    </div>
  </div>
  <div class="col-dt-3 col-smdt-12">
    <div class="information currency-transfer-content info">
      <p class="currency-transfer-content__right-heading">
        {{ 'default.information' | translate }}
      </p>
      <div class="information-content" [ngClass]="{ divide: info1 || info2 }">
        <div
          class="d-flex flex-row justify-content-between information-content__click_area"
          (click)="info1 = !info1">
          <p class="information-content__title">
            {{ 'currencyControl.currencyTransfer.infoTitle1' | translate }}
          </p>
          <img
            src="assets/icons/down_arrow.svg"
            [ngClass]="{
              'information-content__arrow_down': info1 === false,
              'information-content__arrow_up': info1 === true
            }" />
        </div>
        <p class="information-content__text" *ngIf="info1 === true">
          {{ 'currencyControl.currencyTransfer.infoText1' | translate }}
        </p>
      </div>
      <div class="information-content">
        <div
          class="d-flex flex-row justify-content-between information-content__click_area"
          (click)="info2 = !info2">
          <p class="information-content__title">
            {{ 'currencyControl.currencyTransfer.infoTitle2' | translate }}
          </p>
          <img
            src="assets/icons/down_arrow.svg"
            [ngClass]="{
              'information-content__arrow_down': info2 === false,
              'information-content__arrow_up': info2 === true
            }" />
        </div>
        <div class="information-content__text" *ngIf="info2 === true">
          {{ 'currencyControl.currencyTransfer.infoText2' | translate }}
          <ul>
            <li>
              {{
                'currencyControl.currencyTransfer.currencyAgreement' | translate
              }}
            </li>
            <li>
              {{
                'currencyControl.currencyTransfer.additionalContractAgreement'
                  | translate
              }}
            </li>
            <li>
              {{
                'currencyControl.currencyTransfer.paymentDocuments' | translate
              }}
            </li>
            <li>
              {{
                'currencyControl.currencyTransfer.supportingDocuments'
                  | translate
              }}
            </li>
            <li>
              {{
                'currencyControl.currencyTransfer.otherDocuments' | translate
              }}
            </li>
            <li>
              {{ 'currencyControl.currencyTransfer.chatWithBank' | translate }}
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <ob-payment-footer
    [operationType]="'currency-transfer'"
    [commission]="
      commission ? commission : ('operations.default.comissionHint' | translate)
    "
    [comissionLoading]="isCommissionLoading"
    [sum]="getGroupAt(0).controls.amount.value"
    [showBack]="currentStep > 0"
    [currency]="transferCurrency"
    (toNext)="next()"
    (toBack)="prev()"></ob-payment-footer>
</div>
